# KS3 Development & Build Guide

**CRITICAL:** This project uses **Nunjucks (`.njk`)** templates and a static site generator. **DO NOT EDIT HTML FILES IN `public/` DIRECTLY.** Your changes will be overwritten by the build process.

## 1. The Build System

-   **Source of Truth:** `src/pages/ks3/...` (Nunjucks templates)
-   **Output:** `public/ks3/...` (Generated HTML)
-   **Build Command:** `npm run build`

### How it works
1.  You edit a `.njk` file in `src/pages/`.
2.  You run `npm run build`.
3.  The system compiles the `.njk` file + layouts + data into a final `.html` file in `public/`.

---

## 2. Workflow for Agents & Developers

### Creating a New Lesson
1.  **Duplicate a Template:** Copy an existing `.njk` file (e.g., `src/pages/ks3/year7/unit2/L1_digital_you.njk`) to a new filename.
2.  **Update Front Matter:** Edit the YAML at the top of the file:
    ```yaml
    ---
    layout: layouts/ks3-standalone.njk
    title: "L2: Lesson Title | Year 7 Unit 2"
    backHref: ks3/year7/unit2.html
    deckHeader: "Lesson 2 — Title · Year 7 · Unit 2"
    lesson:
      title: "Lesson Title"
      # ... content data ...
    ---
    ```
3.  **Add Content:**
    -   **YAML Data:** Use the `lesson` object for standard slides (Recall, Concepts, Objectives, Hook).
    -   **HTML Body:** Write standard HTML/Reveal.js code *below* the second `---` for custom slides (Main Task, Plenary, Widgets).
4.  **Build:** Run `npm run build` in the terminal.
5.  **Verify:** Open the generated file in `public/` to check your work.

### Updating Existing Content
1.  **Find the Source:** Locate the `.njk` file in `src/pages/ks3/...`.
2.  **Edit:** Make your changes to the Nunjucks template.
3.  **Build:** Run `npm run build`.
4.  **Verify:** Check the output in `public/`.

---

## 3. Deployment

**The CI/CD pipeline handles the final build.**

1.  **Commit & Push:** When you push to `main`, GitHub Actions will:
    -   Run `npm run build`.
    -   Deploy the `public/` folder to GitHub Pages.
2.  **Do NOT commit `public/` manually** unless you have verified it matches the `npm run build` output locally. It is safer to trust the CI to generate the artifacts.

---

## 4. KS3 Content Guidelines

### Standard Arc
1.  **Title Slide:** Auto-generated from Front Matter.
2.  **Recall:** 5 questions to activate prior knowledge.
3.  **Concepts & Skills:** 1-2 slides defining the core focus.
4.  **Objectives:** Clear learning goals.
5.  **Hook:** A "Big Question" or timer-based task to engage students.
6.  **Main Task:** The core activity (often custom HTML).
7.  **Plenary:** Assessment or reflection (Quiz, Discussion).

### Widget Library (for Custom Slides)
-   **Timers:** Use `<div class="timer-widget">...</div>` (see `ks3-theme.css`).
-   **Fragments:** Use `class="fragment fade-up"` for sequential reveals.
-   **Layouts:** Use `.cols` for 2-column layouts and `.box-blue` / `.box-yellow` for content containers.

### Technical Rules
-   **Images:** Store in `public/images/` or relative `images/` folders. Use `alt` text.
-   **Height:** Content must fit within the slide view (no scrolling).
-   **CSS:** Global styles are in `src/css/ks3-deck.css`. Do not use inline styles unless necessary.
