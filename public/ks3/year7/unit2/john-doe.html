<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLASSIFIED - John Doe Dossier</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background: #1a1a1a;
            background-image:
                radial-gradient(ellipse at center, #2a2a2a 0%, #0a0a0a 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Courier New', monospace;
            overflow: hidden;
        }

        /* Desk surface */
        .desk {
            width: 100vw;
            height: 100vh;
            background: #2c2416;
            background-image:
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
            background-blend-mode: overlay;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* The folder container */
        .dossier {
            position: relative;
            width: 500px;
            height: 650px;
            cursor: pointer;
            transition: transform 0.3s ease;
            perspective: 1000px;
        }

        .dossier:hover .folder-front {
            transform: rotateX(-5deg);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .dossier.open {
            width: 95vw;
            height: 90vh;
            max-width: 1400px;
            cursor: default;
        }

        /* Folder back */
        .folder-back {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #8B7355 0%, #6B5344 50%, #5a4535 100%);
            border-radius: 5px 20px 5px 5px;
            box-shadow:
                inset 0 0 50px rgba(0, 0, 0, 0.3),
                0 10px 30px rgba(0, 0, 0, 0.5);
            display: none;
        }

        .dossier.open .folder-back {
            display: block;
            background-image:
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
            background-blend-mode: soft-light;
        }

        /* Folder front (cover) */
        .folder-front {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #c4a574 0%, #a58556 30%, #8B7355 100%);
            border-radius: 5px 20px 5px 5px;
            box-shadow:
                inset 0 2px 0 rgba(255, 255, 255, 0.2),
                inset 0 -5px 20px rgba(0, 0, 0, 0.2),
                0 10px 30px rgba(0, 0, 0, 0.4);
            transform-origin: top center;
            transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 10;
            overflow: hidden;
        }

        .folder-front::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image:
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");
            opacity: 0.15;
            pointer-events: none;
        }

        /* Tab on folder */
        .folder-tab {
            position: absolute;
            top: -25px;
            right: 60px;
            width: 120px;
            height: 30px;
            background: linear-gradient(180deg, #d4b584 0%, #a58556 100%);
            border-radius: 8px 8px 0 0;
            box-shadow: inset 0 2px 0 rgba(255, 255, 255, 0.3);
        }

        .dossier.open .folder-front {
            transform: rotateX(-160deg) translateY(-10px);
            opacity: 0;
            pointer-events: none;
        }

        /* Cover content */
        .cover-content {
            padding: 40px;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .stamp-top-secret {
            background: #8B0000;
            color: #fff;
            padding: 8px 25px;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 4px;
            transform: rotate(-5deg);
            border: 3px solid #600;
            margin-bottom: 30px;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        }

        .fbi-seal {
            width: 150px;
            height: 150px;
            border: 8px solid #1a3a5c;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(135deg, #f0e6d3 0%, #d4c4a8 100%);
            margin-bottom: 30px;
            position: relative;
        }

        .fbi-seal::before {
            content: '★ FBI ★';
            font-size: 20px;
            font-weight: bold;
            color: #1a3a5c;
            text-align: center;
        }

        .fbi-seal::after {
            content: 'FEDERAL BUREAU OF INVESTIGATION';
            position: absolute;
            bottom: 15px;
            font-size: 6px;
            color: #1a3a5c;
            letter-spacing: 1px;
        }

        .subject-label {
            background: #f5f0e1;
            padding: 15px 30px;
            border: 2px solid #333;
            margin-bottom: 20px;
            width: 80%;
            text-align: center;
        }

        .subject-label h2 {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .subject-label h1 {
            font-size: 32px;
            color: #111;
            letter-spacing: 3px;
        }

        .classified-stamp {
            color: #8B0000;
            font-size: 48px;
            font-weight: bold;
            transform: rotate(-15deg);
            opacity: 0.8;
            margin-top: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            letter-spacing: 5px;
        }

        .case-number {
            position: absolute;
            bottom: 40px;
            font-size: 12px;
            color: #555;
        }

        .click-hint {
            position: absolute;
            bottom: 15px;
            font-size: 11px;
            color: #777;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.5;
            }

            50% {
                opacity: 1;
            }
        }

        .dossier.open .click-hint {
            display: none;
        }

        /* Close button */
        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            z-index: 100;
            display: none;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            transition: transform 0.2s, background 0.2s;
        }

        .close-btn:hover {
            background: #a00;
            transform: scale(1.1);
        }

        .dossier.open .close-btn {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Evidence photos container */
        .evidence-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            padding: 60px 40px 40px;
        }

        .dossier.open .evidence-container {
            display: block;
        }

        /* Polaroid style photos */
        .photo {
            position: absolute;
            background: #fff;
            padding: 10px 10px 40px 10px;
            box-shadow:
                0 4px 15px rgba(0, 0, 0, 0.4),
                0 0 0 1px rgba(0, 0, 0, 0.1);
            cursor: grab;
            transition: transform 0.15s ease, box-shadow 0.15s ease, z-index 0s;
            user-select: none;
        }

        .photo::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg,
                    rgba(255, 255, 255, 0.1) 0%,
                    transparent 50%,
                    rgba(0, 0, 0, 0.05) 100%);
            pointer-events: none;
        }

        .photo:hover {
            box-shadow:
                0 8px 25px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(0, 0, 0, 0.1);
            z-index: 50 !important;
        }

        .photo.dragging {
            cursor: grabbing;
            transform: scale(1.05) rotate(0deg) !important;
            box-shadow:
                0 15px 40px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(0, 0, 0, 0.1);
            z-index: 100 !important;
        }

        .photo-inner {
            width: 120px;
            height: 120px;
            background: #ddd;
            overflow: hidden;
            position: relative;
        }

        .photo-inner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: sepia(20%) contrast(1.1) saturate(0.9);
        }

        /* Placeholder styling */
        .photo-inner .placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667 0%, #445 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 10px;
        }

        .photo-label {
            position: absolute;
            bottom: 8px;
            left: 0;
            right: 0;
            text-align: center;
            font-family: 'Courier New', monospace;
            font-size: 10px;
            color: #333;
        }

        /* Red pin/tape effect on some photos */
        .photo.pinned::after {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, #d32f2f 0%, #8B0000 100%);
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .photo.taped::after {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%) rotate(0deg);
            width: 60px;
            height: 20px;
            background: rgba(255, 235, 180, 0.7);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        /* Lightbox modal */
        .lightbox {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .lightbox.active {
            display: flex;
            opacity: 1;
        }

        .lightbox-content {
            background: #fff;
            padding: 20px 20px 80px 20px;
            max-width: 90vw;
            max-height: 90vh;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            transform: scale(0.8);
            transition: transform 0.3s ease;
            position: relative;
        }

        .lightbox.active .lightbox-content {
            transform: scale(1);
        }

        .lightbox-content img {
            max-width: 70vw;
            max-height: 60vh;
            display: block;
        }

        .lightbox-content .placeholder-large {
            width: 500px;
            height: 400px;
            max-width: 70vw;
            max-height: 60vh;
            background: linear-gradient(135deg, #667 0%, #445 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            color: rgba(255, 255, 255, 0.5);
            font-size: 24px;
        }

        .lightbox-caption {
            position: absolute;
            bottom: 20px;
            left: 20px;
            right: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #333;
            text-align: center;
        }

        .lightbox-close {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 40px;
            height: 40px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .lightbox-close:hover {
            background: #a00;
        }

        /* String/yarn connecting evidence */
        .string {
            position: absolute;
            height: 2px;
            background: #8B0000;
            transform-origin: left center;
            pointer-events: none;
            opacity: 0.6;
            display: none;
        }

        .dossier.open .string {
            display: block;
        }

        /* Stamps scattered in folder */
        .folder-stamp {
            position: absolute;
            font-weight: bold;
            opacity: 0.15;
            pointer-events: none;
            display: none;
        }

        .dossier.open .folder-stamp {
            display: block;
        }

        .stamp-1 {
            top: 30%;
            left: 5%;
            font-size: 60px;
            color: #8B0000;
            transform: rotate(-20deg);
        }

        .stamp-2 {
            bottom: 10%;
            right: 5%;
            font-size: 40px;
            color: #1a3a5c;
            transform: rotate(15deg);
        }

        /* Coffee stain */
        .coffee-stain {
            position: absolute;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(ellipse,
                    transparent 30%,
                    rgba(101, 67, 33, 0.1) 50%,
                    rgba(101, 67, 33, 0.2) 60%,
                    transparent 70%);
            pointer-events: none;
            display: none;
        }

        .dossier.open .coffee-stain {
            display: block;
        }

        /* Back Button */
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            text-decoration: none;
            font-family: 'Courier New', monospace;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            z-index: 1000;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .back-btn:hover {
            background: rgba(0, 0, 0, 0.8);
            border-color: rgba(255, 255, 255, 0.6);
        }

        /* Mission Sidebar */
        .mission-sidebar {
            position: fixed;
            top: 80px;
            /* Below back button */
            left: 0;
            width: 300px;
            height: auto;
            max-height: 80vh;
            background: #f0e6d3;
            border: 2px solid #333;
            border-left: none;
            border-radius: 0 10px 10px 0;
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
            z-index: 900;
            transform: translateX(-100%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: flex;
            flex-direction: column;
            font-family: 'Courier New', monospace;
        }

        .mission-sidebar.visible {
            transform: translateX(0);
        }

        .mission-tab {
            position: absolute;
            top: 20px;
            right: -40px;
            width: 40px;
            height: 120px;
            background: #8B0000;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 0 10px 10px 0;
            cursor: pointer;
            box-shadow: 3px 3px 5px rgba(0, 0, 0, 0.3);
            border: 2px solid #5a0000;
            border-left: none;
        }

        .mission-tab span {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-weight: bold;
            letter-spacing: 2px;
            font-size: 14px;
        }

        .mission-content {
            padding: 20px;
            overflow-y: auto;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d4c4a8' fill-opacity='0.4'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z'/%3E%3C/g%3E%3C/svg%3E");
        }

        .mission-header {
            border-bottom: 2px solid #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            text-align: center;
        }

        .mission-header h2 {
            color: #8B0000;
            font-size: 14px;
            letter-spacing: 3px;
            margin-bottom: 5px;
        }

        .mission-header h1 {
            font-size: 24px;
            color: #1a1a1a;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .mission-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.4);
            border: 1px dashed #999;
            border-radius: 5px;
            transition: all 0.3s ease;
        }

        .mission-item.active {
            background: rgba(255, 255, 255, 0.8);
            border-style: solid;
            border-color: #333;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
        }

        .mission-item.locked {
            opacity: 0.5;
            filter: grayscale(1);
            pointer-events: none;
        }

        .mission-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #333;
            margin-right: 15px;
            margin-top: 2px;
            cursor: pointer;
            position: relative;
            background: #fff;
            flex-shrink: 0;
        }

        .mission-checkbox:hover {
            background: #eee;
        }

        .mission-item.completed .mission-checkbox::after {
            content: '✓';
            position: absolute;
            top: -5px;
            left: 2px;
            font-size: 28px;
            color: #8B0000;
            font-weight: bold;
            transform: rotate(-10deg);
        }

        .mission-item.completed {
            text-decoration: line-through;
            opacity: 0.7;
        }

        .mission-text h3 {
            font-size: 14px;
            margin-bottom: 5px;
            color: #000;
            font-weight: bold;
        }

        .mission-text p {
            font-size: 12px;
            color: #444;
            line-height: 1.4;
        }

        .mission-footer {
            margin-top: 20px;
            text-align: center;
            font-size: 10px;
            color: #8B0000;
            letter-spacing: 2px;
            border-top: 1px solid #ccc;
            padding-top: 10px;
        }

        /* Subtasks */
        .subtask-list {
            margin-top: 10px;
            padding-left: 5px;
            width: 100%;
        }

        .subtask-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            font-size: 11px;
            color: #333;
            cursor: pointer;
        }

        .subtask-item:hover .subtask-label {
            text-decoration: underline;
            color: #8B0000;
        }

        .subtask-checkbox {
            width: 16px;
            height: 16px;
            border: 1px solid #555;
            margin-right: 10px;
            background: #fff;
            position: relative;
            flex-shrink: 0;
        }

        .subtask-item.completed .subtask-checkbox::after {
            content: '✓';
            position: absolute;
            top: -4px;
            left: 1px;
            font-size: 18px;
            color: #8B0000;
            font-weight: bold;
        }

        .subtask-item.completed .subtask-label {
            text-decoration: line-through;
            opacity: 0.6;
        }

        /* Mission Modal */
        .mission-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mission-modal.active {
            display: flex;
            opacity: 1;
        }

        .mission-modal-content {
            width: 500px;
            max-width: 90vw;
            background: #f0e6d3;
            padding: 30px;
            border: 2px solid #333;
            box-shadow: 10px 10px 30px rgba(0, 0, 0, 0.5);
            font-family: 'Courier New', monospace;
            position: relative;
            transform: scale(0.9);
            transition: transform 0.3s ease;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23d4c4a8' fill-opacity='0.4'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z'/%3E%3C/g%3E%3C/svg%3E");
        }

        .mission-modal.active .mission-modal-content {
            transform: scale(1);
        }

        .modal-header {
            border-bottom: 2px solid #8B0000;
            margin-bottom: 20px;
            padding-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: #1a1a1a;
            text-transform: uppercase;
        }

        .modal-stamp {
            border: 2px solid #8B0000;
            color: #8B0000;
            padding: 2px 8px;
            font-size: 12px;
            font-weight: bold;
            transform: rotate(-5deg);
        }

        .modal-body {
            font-size: 14px;
            line-height: 1.6;
            color: #333;
        }

        .modal-close-btn {
            position: absolute;
            top: -15px;
            right: -15px;
            width: 30px;
            height: 30px;
            background: #8B0000;
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .modal-close-btn:hover {
            background: #a00;
        }
    </style>
</head>

<body>
    <a href="activity1.html" class="back-btn">← RETURN TO HQ</a>

    <!-- Mission Sidebar -->
    <div id="missionSidebar" class="mission-sidebar">
        <div class="mission-tab" id="missionTab">
            <span>MISSION</span>
        </div>
        <div class="mission-content">
            <div class="mission-header">
                <h2>TOP SECRET</h2>
                <h1>OBJECTIVES</h1>
            </div>
            <div class="mission-list">
                <!-- Task 1 -->
                <div class="mission-item active" id="task1">
                    <div class="mission-text" style="width: 100%;">
                        <h3>1. IDENTIFY SUBJECT</h3>
                        <div class="subtask-list">
                            <div class="subtask-item" id="st1-1" onclick="toggleSubtask('task1', 'st1-1')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st1-1')">
                                    Find Name</div>
                            </div>
                            <div class="subtask-item" id="st1-2" onclick="toggleSubtask('task1', 'st1-2')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st1-2')">
                                    Find Date of Birth</div>
                            </div>
                            <div class="subtask-item" id="st1-3" onclick="toggleSubtask('task1', 'st1-3')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st1-3')">
                                    Find City</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Task 2 -->
                <div class="mission-item locked" id="task2">
                    <div class="mission-text" style="width: 100%;">
                        <h3>2. GATHER INTEL</h3>
                        <div class="subtask-list">
                            <div class="subtask-item" id="st2-1" onclick="toggleSubtask('task2', 'st2-1')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st2-1')">
                                    Find 7 more clues</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Task 3 -->
                <div class="mission-item locked" id="task3">
                    <div class="mission-text" style="width: 100%;">
                        <h3>3. RECORD EVIDENCE</h3>
                        <div class="subtask-list">
                            <div class="subtask-item" id="st3-1" onclick="toggleSubtask('task3', 'st3-1')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st3-1')">
                                    Complete Evidence Table</div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Task 4 -->
                <div class="mission-item locked" id="task4">
                    <div class="mission-text" style="width: 100%;">
                        <h3>4. ANALYZE & REFLECT</h3>
                        <div class="subtask-list">
                            <div class="subtask-item" id="st4-1" onclick="toggleSubtask('task4', 'st4-1')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st4-1')">
                                    Build Profile</div>
                            </div>
                            <div class="subtask-item" id="st4-2" onclick="toggleSubtask('task4', 'st4-2')">
                                <div class="subtask-checkbox"></div>
                                <div class="subtask-label" onclick="event.stopPropagation(); openMissionModal('st4-2')">
                                    Identify Privacy Risks</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="mission-footer">
                CONFIDENTIAL // EYES ONLY
            </div>
        </div>
    </div>

    <div class="desk">
        <div class="dossier" id="dossier">
            <!-- Folder Back -->
            <div class="folder-back">
                <div class="evidence-container" id="evidenceContainer">
                    <!-- Photos will be generated by JS -->
                </div>

                <!-- Decorative elements -->
                <div class="folder-stamp stamp-1">CLASSIFIED</div>
                <div class="folder-stamp stamp-2">EVIDENCE</div>
                <div class="coffee-stain" style="top: 20%; right: 15%;"></div>

                <button class="close-btn" id="closeBtn">×</button>
            </div>

            <!-- Folder Front (Cover) -->
            <div class="folder-front">
                <div class="folder-tab"></div>
                <div class="cover-content">
                    <div class="stamp-top-secret">TOP SECRET</div>
                    <div class="fbi-seal"></div>
                    <div class="subject-label">
                        <h2>SUBJECT</h2>
                        <h1>JOHN DOE</h1>
                    </div>
                    <div class="classified-stamp">CLASSIFIED</div>
                    <div class="case-number">CASE NO. 2024-JD-0042</div>
                    <div class="click-hint">[ CLICK TO OPEN ]</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lightbox Modal -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-content">
            <button class="lightbox-close" id="lightboxClose">×</button>
            <div id="lightboxImage"></div>
            <div class="lightbox-caption" id="lightboxCaption"></div>
        </div>
    </div>

    <!-- Mission Modal -->
    <div class="mission-modal" id="missionModal">
        <div class="mission-modal-content">
            <button class="modal-close-btn" onclick="closeMissionModal()">×</button>
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">MISSION BRIEF</div>
                <div class="modal-stamp">EYES ONLY</div>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>

    <script>
        // Evidence data with captions and filenames
        const evidenceData = [
            { id: 1, src: "images/evidence1.png", caption: "Subject photographed at Grand Central Station - 03/15/2024" },
            { id: 2, src: "images/evidence2.png", caption: "Vehicle registered to subject - License plate redacted" },
            { id: 3, src: "images/Evidence3.png", caption: "Known associate meeting at undisclosed location" },
            { id: 4, src: "images/Evidence 4.png", caption: "Surveillance photo - Downtown district" },
            { id: 5, src: "images/Evidence5.png", caption: "Document fragment recovered from subject's residence" },
            { id: 6, src: "images/Evidence6.png", caption: "Subject entering warehouse - Industrial zone" },
            { id: 7, src: "images/Evidence7.png", caption: "Communication device found at drop point" },
            { id: 8, src: "images/Evidence8.png", caption: "Secondary location under surveillance" },
            { id: 9, src: "images/Evidence9.png", caption: "Financial transaction evidence" },
            { id: 10, src: "images/Evidence10.png", caption: "Subject with unidentified individual" },
            { id: 11, src: "images/Evidence11.png", caption: "Aerial surveillance - Property of interest" },
            { id: 12, src: "images/Evidence12.png", caption: "Evidence item recovered from scene" },
            { id: 13, src: "images/Evidence13.png", caption: "Timeline documentation - Key event" },
            { id: 14, src: "images/Evidence 14.png", caption: "Background investigation photo" },
            { id: 15, src: "images/Evidence15.png", caption: "Final surveillance capture - Current status: UNKNOWN" }
        ];

        // DOM elements
        const dossier = document.getElementById('dossier');
        const closeBtn = document.getElementById('closeBtn');
        const evidenceContainer = document.getElementById('evidenceContainer');
        const lightbox = document.getElementById('lightbox');
        const lightboxImage = document.getElementById('lightboxImage');
        const lightboxCaption = document.getElementById('lightboxCaption');
        const lightboxClose = document.getElementById('lightboxClose');

        let isOpen = false;
        let photos = [];
        let activePhoto = null;
        let offsetX, offsetY;
        let highestZ = 1;

        // Generate random positions for photos
        function generatePhotoPositions() {
            const positions = [];
            const containerRect = evidenceContainer.getBoundingClientRect();
            const padding = 80;

            for (let i = 0; i < 15; i++) {
                positions.push({
                    x: padding + Math.random() * (containerRect.width - 200 - padding * 2),
                    y: padding + Math.random() * (containerRect.height - 200 - padding * 2),
                    rotation: (Math.random() - 0.5) * 30
                });
            }
            return positions;
        }

        // Create photo elements
        function createPhotos() {
            evidenceContainer.innerHTML = '';
            const positions = generatePhotoPositions();

            evidenceData.forEach((evidence, index) => {
                const photo = document.createElement('div');
                photo.className = 'photo';

                // Add random decorations
                if (Math.random() > 0.7) photo.classList.add('pinned');
                else if (Math.random() > 0.5) photo.classList.add('taped');

                photo.style.left = `${positions[index].x}px`;
                photo.style.top = `${positions[index].y}px`;
                photo.style.transform = `rotate(${positions[index].rotation}deg)`;
                photo.style.zIndex = index + 1;

                photo.innerHTML = `
          <div class="photo-inner">
            <img src="${evidence.src}" alt="Evidence ${evidence.id}" draggable="false">
          </div>
          <div class="photo-label">EVIDENCE #${evidence.id}</div>
        `;

                photo.dataset.id = evidence.id;
                photo.dataset.caption = evidence.caption;
                photo.dataset.src = evidence.src;
                photo.dataset.rotation = positions[index].rotation;

                evidenceContainer.appendChild(photo);
                photos.push(photo);

                // Event listeners
                photo.addEventListener('mousedown', startDrag);
                photo.addEventListener('click', handlePhotoClick);
            });
        }

        // Open/Close dossier
        function toggleDossier(e) {
            if (isOpen) return;

            isOpen = true;
            dossier.classList.add('open');

            setTimeout(() => {
                if (photos.length === 0) {
                    createPhotos();
                }
                animatePhotosIn();
            }, 300);
        }

        function closeDossier() {
            isOpen = false;
            dossier.classList.remove('open');
        }

        // Animate photos scattering in
        function animatePhotosIn() {
            photos.forEach((photo, index) => {
                photo.style.opacity = '0';
                photo.style.transform = `rotate(0deg) scale(0.5)`;

                setTimeout(() => {
                    photo.style.transition = 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)';
                    photo.style.opacity = '1';
                    photo.style.transform = `rotate(${photo.dataset.rotation}deg) scale(1)`;

                    setTimeout(() => {
                        photo.style.transition = 'transform 0.15s ease, box-shadow 0.15s ease';
                    }, 400);
                }, index * 50);
            });
        }

        // Drag functionality
        let isDragging = false;
        let hasDragged = false;

        function startDrag(e) {
            if (e.button !== 0) return;

            activePhoto = e.currentTarget;
            isDragging = true;
            hasDragged = false;

            const rect = activePhoto.getBoundingClientRect();
            offsetX = e.clientX - rect.left;
            offsetY = e.clientY - rect.top;

            highestZ++;
            activePhoto.style.zIndex = highestZ;
            activePhoto.classList.add('dragging');

            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);

            e.preventDefault();
        }

        function drag(e) {
            if (!isDragging || !activePhoto) return;

            hasDragged = true;

            const containerRect = evidenceContainer.getBoundingClientRect();
            let newX = e.clientX - containerRect.left - offsetX;
            let newY = e.clientY - containerRect.top - offsetY;

            // Boundary constraints
            newX = Math.max(0, Math.min(newX, containerRect.width - 150));
            newY = Math.max(0, Math.min(newY, containerRect.height - 180));

            activePhoto.style.left = `${newX}px`;
            activePhoto.style.top = `${newY}px`;
        }

        function stopDrag(e) {
            if (activePhoto) {
                activePhoto.classList.remove('dragging');
                activePhoto.style.transform = `rotate(${activePhoto.dataset.rotation}deg)`;
            }

            isDragging = false;
            activePhoto = null;

            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }

        // Photo click to open lightbox
        function handlePhotoClick(e) {
            if (hasDragged) {
                hasDragged = false;
                return;
            }

            const photo = e.currentTarget;
            const caption = photo.dataset.caption;
            const src = photo.dataset.src;

            lightboxImage.innerHTML = `<img src="${src}" alt="Evidence">`;
            lightboxCaption.textContent = caption;
            lightbox.classList.add('active');
        }

        // Close lightbox
        function closeLightbox() {
            lightbox.classList.remove('active');
        }

        // Event listeners
        dossier.querySelector('.folder-front').addEventListener('click', toggleDossier);
        closeBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeDossier();
        });
        lightboxClose.addEventListener('click', closeLightbox);
        lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) closeLightbox();
        });

        // Keyboard support
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                if (lightbox.classList.contains('active')) {
                    closeLightbox();
                } else if (isOpen) {
                    closeDossier();
                }
            }
        });

        // Mission Sidebar Logic
        const missionSidebar = document.getElementById('missionSidebar');
        const missionTab = document.getElementById('missionTab');

        missionTab.addEventListener('click', () => {
            missionSidebar.classList.toggle('visible');
        });

        // Auto-open sidebar when dossier opens
        const originalToggleDossier = toggleDossier;
        toggleDossier = function (e) {
            originalToggleDossier(e);
            setTimeout(() => {
                missionSidebar.classList.add('visible');
            }, 800);
        };

        // Mission Data
        const missionDetails = {
            'st1-1': {
                title: 'FIND NAME',
                content: 'Search the evidence for any mention of the subject\'s full name. Look at documents, ID cards, or correspondence.'
            },
            'st1-2': {
                title: 'FIND DATE OF BIRTH',
                content: 'Locate a document that lists the subject\'s Date of Birth (Day and Month required). Check official records or personal notes.'
            },
            'st1-3': {
                title: 'FIND CITY',
                content: 'Identify the city where the subject currently resides. Look for addresses on mail, receipts, or location tags.'
            },
            'st2-1': {
                title: 'GATHER INTEL',
                content: 'Find at least 7 more pieces of information. Look for:<br>- Hobbies<br>- Daily Routine<br>- Places Visited<br>- Likes/Dislikes<br>- Family Members<br>- Financial Habits'
            },
            'st3-1': {
                title: 'RECORD EVIDENCE',
                content: 'Create a table in your exercise book with the following columns:<br>1. Image Number<br>2. What information does this image reveal?<br>3. Should this be public or private? Why?'
            },
            'st4-1': {
                title: 'BUILD PROFILE',
                content: 'Write 4-5 bullet points describing what kind of person John appears to be based ONLY on the information you found.'
            },
            'st4-2': {
                title: 'IDENTIFY RISKS',
                content: 'Choose three items from your table that should have stayed private. For each one, write one sentence explaining the risk.'
            }
        };

        // Modal Logic
        const missionModal = document.getElementById('missionModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalBody = document.getElementById('modalBody');

        function openMissionModal(subtaskId) {
            const data = missionDetails[subtaskId];
            if (data) {
                modalTitle.textContent = data.title;
                modalBody.innerHTML = data.content;
                missionModal.classList.add('active');
            }
        }

        function closeMissionModal() {
            missionModal.classList.remove('active');
        }

        // Subtask Logic
        const taskDependencies = {
            'task1': ['st1-1', 'st1-2', 'st1-3'],
            'task2': ['st2-1'],
            'task3': ['st3-1'],
            'task4': ['st4-1', 'st4-2']
        };

        const taskOrder = ['task1', 'task2', 'task3', 'task4'];

        function toggleSubtask(taskId, subtaskId) {
            const subtask = document.getElementById(subtaskId);
            subtask.classList.toggle('completed');

            checkTaskProgress();
        }

        function checkTaskProgress() {
            let locked = false;

            taskOrder.forEach((taskId, index) => {
                const taskEl = document.getElementById(taskId);

                if (locked) {
                    taskEl.classList.add('locked');
                    taskEl.classList.remove('active');
                    return;
                }

                // Unlock this task
                taskEl.classList.remove('locked');
                taskEl.classList.add('active');

                // Check if this task is fully complete
                const subtasks = taskDependencies[taskId];
                const allComplete = subtasks.every(stId => document.getElementById(stId).classList.contains('completed'));

                if (!allComplete) {
                    locked = true; // Lock subsequent tasks
                }
            });
        }

    </script>
</body>

</html>